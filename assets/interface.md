---
title: 3. Интерфейс сайта
section: 3
---

# Интерфейс сайта

## Система виджетов

Основная страница интерфейса представлена набором таблиц-виджетов, которые расположены в выпадающем списке `Widgets`. Все виджеты могут быть открыты и закрыты в любом количестве и порядке, кроме виджета `Robot logs`, который открыт всегда в единственном экземпляре. Сайт существует в десктопном и мобильном (адаптированном для смартфонов) вариантах. Все положения данной главы применимы к обоим вариантам, если не указано иное. В десктопном варианте можно перемещать виджеты внутри окна браузера и изменять их размеры, в мобильном варианте единовременно открыт только один виджет, занимая при этом всё окно браузера, остальные виджеты существуют в виде вкладок, между которыми возможно переключение.

|![Alt text](@images/widgets_list.png)|
|:--:|
| *Рис. 1* |

Стоит заметить, что все виджеты настраиваемые. Можно менять местами столбцы, регулировать их ширину, а так же скрывать ненужные столбцы через закладку `Columns`. Возможно одновременное открытие нескольких одинаковых виджетов с использованием в них разных настроек. Настроенное рабочее пространство можно сохранить в `Workspaces` и позже загружать его на другие устройства. Также есть возможность экспорта и импорта `Workspaces` через файл. Это позволяет пользователям с несколькими ролями перенести настроенные `Workspaces` из одной роли в другую.

### Элементы управления виджета

Все виджеты имеют общие черты. Так, внешний вид элементов управления един для всех виджетов. Рассмотрим его на примере виджета `Portfolios table`.

|![Alt text](@images/widget_header.png)|
|:--:|
| *Рис. 2* |

Разберём подробно элементы интерфейса виджета, отмеченные ни рисунке 2 числами. В разных виджетах те или иные элементы интерфейса могут отсутствовать по причине не применимости данного элемента к содержимому конкретного виджета. Кроме того, в верхней строке виджета могут присутствовать дополнительные элементы управления, характерные только для конкретного виджета, такие элементы управления будут описаны отдельно.

1. Заголовок виджета. Кроме имени виджета может содержать дополнительную информацию, такую как номер робота для виджетов, содержащих данные по конкретному роботу. В десктопном варианте сайта возможно перемещение виджета внутри страницы сайта мышкой за заголовок.
2. Фильтр, применяется только в виджете `Portfolios table`, позволяет скрыть портфели, не удовлетворяющие критериям фильтра. Фильтрация портфелей осуществляется непосредственно на сервере, на сайт отправляются только портфели, удовлетворяющие условиям фильтра. Рекомендуется первичную фильтрацию выполнять именно с помощью фильтра, так как он, в отличие от строки поиска, снижает количество данных, передаваемых по сети, что положительно сказывается на отзывчивости интерфейса сайта. Фильтрация осуществляется без учёта регистра букв, т.е. строчные и заглавные буквы при фильтрации неотличимы.
3. Строка поиска, позволяет осуществлять фильтрацию данных, уже загруженных в таблицу. Поиск осуществляется без учёта регистра букв, т.е. строчные и заглавные буквы при поиске неотличимы.
4. Список действий, применяемых к выбранным элементам таблицы. Может быть отдельным пунктом, а может быть скрыт под шестеренкой из пункта 5.
5. Настройки виджета, могут так же содержать список действий над выбранными элементами таблицы.
6. Кнопки управления окном виджета: развернуть виджет на всю рабочую область и закрыть виджет.
7. Управление отображением столбцов таблицы, с помощью этого меню можно отключать отображение столбцов таблицы, значения которых Вас не интересуют.
8. "Тело" виджета, представляет из себя таблицу. Возможности таблиц будут описаны далее.
9. Элемент, упрощающий группировку строк. Для включения группировки строк таблицы по значения определенного столбца достаточно заголовок нужного столбца таблицы перетащить мышкой или пальцем на эту надпись.

### Возможности таблиц

|![Alt text](@images/table_functions.png)|
|:--:|
| *Рис. 3* |

Доступ к большинству функций таблиц осуществляется либо через элементы управления виджета, описанные выше, либо через заголовок. Клик на заголовке столбца приводит к сортировке, при наведении курсора на заголовок столбца появляется кнопка меню, меню в открытом виде выглядит как на рисунке 3. В таблицах виджетов поддерживаются следующие функции из числа не описанных выше:

- **Сортировка** - сортировка строк таблицы в соответствии со значениями конкретного столбца.
- **Группировка** - группировка строк таблицы в соответствии со значениями конкретного столбца. Пример группировки по столбцу `Robot` показан на рисунке 4.
    
 |![Alt text](@images/table_group.png)|
 |:--:|
 | *Рис. 4* |

- **Фиксация столбца** - фиксация столбца слева или справа таблицы. Такой столбец не будет перемещаться при горизонтальной прокрутке. Чаще всего фиксируют столбцы, которые однозначно идентифицируют строку, например идентификатор робота или имя портфеля. Можно фиксировать несколько столбцов.
- **Автоматическое изменение ширины столбца** - автоматическое изменение ширины столца в соответствии с содержимым всех строк таблицы.
- **Выделение жирным** - выделение жирным всех значений выбранного столца.
- **Изменение цвета** - изменение цвета всех значений выбранного столбца.

### Сохранение состояния виджетов

С помощью меню `Workspaces` есть возможность сохранения текущей конфигурации рабочего пространства. При этом сохраняется состояние виджетов (открыт или закрыт виджет, положение на рабочем пространстве для открытых виджетов), состояние таблиц (размеры столбцов, настройки отображения столбцов, сортировка, группировка и т.д.) Кроме того, сохраняются фильтры, примененные к таблице портфелей. Можно сохранять до 10 рабочих пространств. В дальнейшем рабочее пространство можно загрузить, чтобы получить привычную рабочую среду на другом устройстве. Сохраненные конфигурации можно обновлять, удалять, а так же экспортировать в файл для дальнейшей импорта. Экспорт в файл и импорт из файла позволяют пользователям с несколькими ролями перенести настроенные `Workspaces` из одной роли в другую.

## Описание виджетов

На сайте используется система ролей пользователей. Для разных ролей могут быть доступны разные виджеты, наполнение виджетов от роли к роли так же может меняться, например, под одной ролью могут отсутствовать столцы таблицы, доступные под другой. Будем рассматривать виджеты и наполнение виджетов в том виде, в каком оно отображается для пользователя под ролью `Trader`. Виджеты, доступные под этой ролью, будут описаны далее.

### Robot logs <Anchor :ids="['robot_logs']" />

Виджет, отображающий текущие логи по всем доступным пользователю роботам. Логи в виджете копятся с момента последней загрузки страницы. Этот виджет нельзя скрыть. Виджет всегда представлен в единственном экземпляре.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время наступления события, отображается локальное время в соотвествии с часовым поясом, используемым на устройстве пользователя;
- **Level** - уровень логирования;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Message** - текст сообщения;

### Robots table <Anchor :ids="['robots_table']" />

Виджет, содержащий список доступных роботов и справочную информацию по ним. Например, из этого виджета можно понять сколько дней до кончания лицензии или сколько торговых подключений можно создать в конкретном роботе. В этом виджете отображается локальное время сервера, на котором находится конкретный робот. Именно на это время стоит ориентироваться при задании расписания.

### Portfolios table <Anchor :ids="['portfolios_table']" />

Виджет, содержащий таблицу портфелей. По сути основной виджет, используемый при торговле. Через этот виджет осуществляется создание новых портфелей, удаление старых и изменение параметров существующих портфелей. Кнопка `ADD` используется для создания новых [портфелей](getting-started.md#portfolio_add). В меню `ACTIONS` находятся действия, которые можно выполнять с одним или несколькими портфелями. Описание действий с портфелями находится [тут](getting-started.md#portfolio_actions). Значения столбцов таблицы совпадают с [параметрами портфеля](params-description.md#p).

### Robot logs history <Anchor :ids="['robot_logs_history']" />

Виджет, содержащий логи по заданному роботу за конкретный период времени. Поддерживается фильтрация логов по ключевым словам, в качестве ключевого слова можно, например, использовать имя портфеля или торгового подключения. Поддерживается экспорт содержимого таблицы в файл.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время наступления события, отображается локальное время в соотвествии с часовым поясом, используемым на устройстве пользователя;
- **Level** - уровень логирования;
- **Robot** - идентификатор робота;
- **Portfolio** - имя портфеля;
- **Message** - текст сообщения.

### Finres for today <Anchor :ids="['finres_for_today']" />

Виджет, содержащий последние раздвижки. Есть возможность отображения всех раздвижек по роботу или только по конкретному портфелю. Так же для конкретного портфеля можно рассчитать среднюю раздвижку на заданном временном отрезке.

### Finres history <Anchor :ids="['finres_history']" />

Виджет, отображающий раздвижки за конкретный период времени. Есть возможность отображения всех раздвижек по роботу или только по конкретному портфелю. Так же для конкретного портфеля можно рассчитать среднюю раздвижку на заданном временном отрезке. Поддерживается экспорт содержимого таблицы в файл.

### Data connections <Anchor :ids="['data_connections']" />

Виджет, отображающий маркет-дата подключения. Для таких подключений доступны перевод в активное состояние (`Enabled`), в неактивное состояние (`Disabled`) и переподключение. Редко используемые подключения по умолчанию скрыты, для их отображения нужно снять флаг `Hide extra connections` в настройках виджета.

**Неочевидный момент:**  
В роботе не предусмотрен отдельный интерфейс добавления маркет-дата подключений. Но при добавлении некоторых транзакционных подключений есть возможность создания маркет-дата подключений. Такая особенность связана с тем, что некоторые маркет-дата подключения не являются публичными, они требуют авторизации. В нашем случае такие маркет-дата подключения используют авторизационные данные, указанные при создании торгового подключения. Если маркет-дата подключение создано при добавлении транзакционного подключения, то эти два подключения считаются связанными друг с другом, перевод одного из них в состояние `Disabled` приведет в переводу в состояние `Disabled` второго подключения. Маркет-дата подключение, созданное вместе с транзакционным подключением, будет удалено при удалении соответствующего транзакционного подключения.

### Trade connections <Anchor :ids="['trade_connections']" />

Виджет, отображающий торговые (транзакционные) подключения. Доступны добавление нового подключения и следующие действия с существующими подключениями: перевод в активное состояние (`Enabled`), перевод в неактивное состояние (`Disabled`), переподключение и изменение настроек подключения. Посмотреть текущие настройки подключения можно через тот же пункт меню, через который осуществляется изменение настроек.

### Trade connections orders <Anchor :ids="['trade_connections_orders']" />

Виждет, отображающий активные заявки по инструментам, содержащимся в портфелях пользователя. Отображаемые заявки могут быть выставлены как конкретным роботом, так и иным способом (другим роботом, через терминал и т.д.). Желтым цветом отмечаются строки, соответствующие тем заявкам, которые не отслеживаются роботом. Роботом не отслеживаются заявки, выставленные через терминал, выставленные через другого робота, выставленные через механизм выставления заявок мимо алгоритма виджета [Trade connections positions](interface.md#trade_connections_positions), а так же "потерянные" при перезапуске робота, если робот был перезапущен с активными заявками. Через этот виджет возможно снятие любой отображаемой в виджете заявки.

Виджет доступен не для всех подключений. Неподдерживаемые подключения нелья выбрать в виджете.

### Trade connections positions <Anchor :ids="['trade_connections_positions']" />

Виджет, отображающий текущие биржевые позиции по валютам и по инструментам (если есть такая возможность, чаще всего позиции по инструментам доступны при торговле деривативами). По умолчанию отображаются все ненулевые позиции по инструментам (даже если этих инструментов нет ни в одном из портфелей) и позиции по инструментам, входящим в хотя бы один из портфелей робота (даже если эти позиции нулевые).

Если для биржи доступно отображение позиций и по валютам, и по инструментам, то в виджете будет отображено две отдельные таблицы.

В таблице позиций по бумагам отображаются биржевая позиция по бумаге и позиция робота по бумаге, вычисленная как сумма позиций данной бумаги по всем портфелям, ее содержащим.

Пара виджетов [Trade connections orders](interface.md#trade_connections_orders) и [Trade connections positions](interface.md#trade_connections_positions) призвана в какой-то мере заменить терминал. Поэтому из данного виджета из таблицы позиций по инструментам доступно выставление заявок мимо алгоритма робота (аналог выставления заявки из терминала) для выравнивания разницы между биржевой позицией и позицией робота по бумаге в случае, если эти позиции не совпадают.

Виджет доступен не для всех подключений. Неподдерживаемые подключения нелья выбрать в виджете.

### Deals for today <Anchor :ids="['deals_for_today']" />

Виджет, содержащий последние сделки. Есть возможность отображения всех сделок по роботу, или только по конкретному портфелю, или по конкретной бумаге портфеля. В этот виджет попадают все сделки, совершенные роботом, кроме сделок по заявкам, выставленным через виджет [Trade connections positions](interface.md#trade_connections_positions). Позиция по инструментам портфеля считается по тем же данным, которые используются в данной таблице.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время сделки, отображается локальное время в соотвествии с часовым поясом, используемым на устройстве пользователя;
- **oNo** - внутренний номер заявки, не всегда совпадающий с биржевым (для MOEX внутренний номер совпадает с биржевым);
- **Name** - имя портфеля;
- **Security** - название инструмента;
- **Target price** - цена первоначально выставленной заявки, значение указывается только для заявок второй ноги, в случае переставления заявки второй ноги по стоп-лоссу или таймеру в данном поле всегда будет указана цена выставления самой первой заявки из этой цепочки, т.е та цена, которая была получена на основе бида или оффера, запомненных на момент выставления заявки по первой ноге;
- **Price** - цена сделки, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке;
- **Buy/Sell** - направление заявки: `Buy` или `Sell`;
- **Quantity** - количество в сделке, в случае наличия флага `Aggregated` количество в сделке может не совпадать с количеством в конкретной сделке в терминале, так как в таком случае строка, помеченная флагом `Aggregated` может являться агрегацией из нескольких подряд прошедших сделок по одной заявке;
- **Curpos** - позиция по инструменту портфеля после обработки данной сделки;
- **Connection** - торговое подключение, через которое была выставлена заявка, приведшая к данной сделке;
- **Aggregation** - флаг, наличие которого сигнализирует о том, что отображаемая сделка на самом деле может являться агрегацией нескольких сделок.

### Deals history <Anchor :ids="['deals_history']" />

Виджет, отображающий сделки за указанный период времени. Есть возможность отображения всех сделок по роботу, или только по конкретному портфелю, или по конкретной бумаге портфеля. Позиция по инструментам портфеля считается по тем же данным, которые используются в данной таблице. Поддерживается экспорт содержимого таблицы в файл.

В основной таблице виджета присутствуют следующие столбцы:

- **Date/Time** - дата и время сделки, отображается локальное время в соотвествии с часовым поясом, используемым на устройстве пользователя;
- **oNo** - внутренний номер заявки, не всегда совпадающий с биржевым (для MOEX внутренний номер совпадает с биржевым);
- **Name** - имя портфеля;
- **Security** - название инструмента;
- **Target price** - цена первоначально выставленной заявки, значение указывается только для заявок второй ноги, в случае переставления заявки второй ноги по стоп-лоссу или таймеру в данном поле всегда будет указана цена выставления самой первой заявки из этой цепочки, т.е та цена, которая была получена на основе бида или оффера, запомненных на момент выставления заявки по первой ноге;
- **Price** - цена сделки, в связи с ориентацией робота на максимальную скорость работы, особенностями подключений к некоторым биржам и агрегацией сделок на некоторых площадках вместо цены конкретной сделки может использоваться цена заявки, средняя цена сделок по заявке или худшая из цен сделок, прошедших по заявке;
- **Buy/Sell** - направление заявки: `Buy` или `Sell`;
- **Quantity** - количество в сделке, в случае наличия флага `Aggregated` количество в сделке может не совпадать с количеством в конкретной сделке в терминале, так как в таком случае строка, помеченная флагом `Aggregated` может являться агрегацией из нескольких подряд прошедших сделок по одной заявке;
- **Curpos** - позиция по инструменту портфеля после обработки данной сделки;
- **Connection** - торговое подключение, через которое была выставлена заявка, приведшая к данной сделке;
- **Aggregation** - флаг, наличие которого сигнализирует о том, что отображаемая сделка на самом деле может являться агрегацией нескольких сделок.
